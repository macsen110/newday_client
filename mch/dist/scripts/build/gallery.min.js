webpackJsonp([10],{

/***/ 43:
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * Created by wudi on 15/11/30.
 */
 !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(2)], __WEBPACK_AMD_DEFINE_RESULT__ = (function($, template) {  
	
	 var pageInitObj = {
		$rootDom: $('#page_container'),
		ui: {},
		ready: function (stateObj, data) {
			var html = __webpack_require__(66);
			if (APP.router.curPathName == stateObj.pageName) {
				APP.router.setRouter(stateObj, this);
				this.show(html, data)
			}
		},
		show: function (tplScript, data) {
			APP.tools.pageCount();
			this.$rootDom.append(tplScript);
			var html = template('gallery_template', data);
			this.$rootDom.prepend(html);
			this.bindUI();
			APP.selectBottomNav(-2)
		},
		_setPageInfo: function () {
			APP.tools.setPageTitle('B超相册')
		},
		bindUI: function () {
			var self = this;
			self._setPageInfo();
			self.$rootDom.addClass('page-gallery visibile');
		   // self.$rootDom.height(self.$rootDom[0].scrollHeight);
			var $mask = self.$rootDom.find('.mask');
			self.$rootDom.find('.img').on('click', function () {
				var src = $(this).attr('src');
				var time = $(this).data('time');
				$mask.show().find('.img').attr('src', src);
				$mask.find('.date').text(time)
			})
			$mask.find('.icon-close').on('click', function () {
				$mask.hide()
			})
		},
		init: function (stateObj) {
			var self = this;
			var data = {
				request_context: {
					customerId:  APP.profileInfo.customerId,
					appType:  APP.openType,
					uid: APP.uid                    
				},
				access_token: localStorage.getItem('token'),
				system: 'mch'
			};
			$.ajax({
				url : APP.host.api + '/infanthospital/v1/childFirstTime',
				data: JSON.stringify(data),
				type : 'post',
				contentType : 'application/json',
				success: function (res) {
					if(res.ret == 1) {
						var obj = {
							data: self._todoData(res.data)
						}
						self.ready(stateObj, obj)
					}
					else {
						APP.ui.showPrompt(res.msg)
						APP.router.endLoading()
					}
				},
				error: function () {
					APP.ui.showPrompt('网络异常,请稍后重试')
					APP.router.endLoading()
				}
			})
			
		},
		_todoData: function (data) {
			var filterTime = function (time) {
				var arr = time.split('-');
				return arr[1]+'.'+arr[2]
			};
			data.forEach(function (item) {
				item.time = filterTime(item.reportDate)
			})
			return data
		},
		destroy: function () {
			//如果有事件绑定的话, 解除事件绑定
			this.$rootDom.scrollTop(0);
			this.$rootDom.removeClass('page-gallery visibile');
			this.$rootDom.html('');
		} 
	};
	
	return pageInitObj

	
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ }),

/***/ 66:
/***/ (function(module, exports) {

module.exports = "<script type=\"text/html\" id=\"gallery_template\">\r\n{{if data.length == 0}}\r\n<div class=\"bg-head\"></div>\r\n<div class=\"main\">\r\n    <div class=\"streach\"></div>\r\n    <div class=\"streach-cloud\"></div>\r\n    <div class=\"bg-ani-footer\"></div>\r\n    <div class=\"tip icon\">\r\n        <p>快带宝贝去做B超吧</p>\r\n        <p>相册会在B超报告生成后显示</p>\r\n        <p>请耐心等待</p>\r\n        <p>(目前仅显示20周前的B超照片)</p>\r\n    </div>\r\n</div>\r\n{{else}}\r\n<div class=\"bg-head\"></div>\r\n<div class=\"bg-head-words\"></div>\r\n<div class=\"main\">\r\n    <div class=\"streach\"></div>\r\n    <div class=\"streach-cloud\"></div>\r\n    <ul class=\"list\">\r\n        {{each data}}\r\n        <li class=\"item\">\r\n            <img data-time=\"{{$value.time}}\" src=\"{{$value.imageUrlInit}}\" alt=\"\" class=\"img\">\r\n            <span class=\"sign\">{{$value.time}}</span>\r\n        </li>\r\n        {{/each}}\r\n    </ul>\r\n    <div class=\"bg-ani-footer\"></div>\r\n</div>\r\n<div class=\"mask\">\r\n    <div class=\"mask-content\">\r\n        <img src=\"\" class=\"img\" alt=\"\">\r\n        <p class=\"date\"></p>\r\n    </div>\r\n    <i class=\"icon-close\">X</i>\r\n</div>\r\n{{/if}}\r\n</script>\r\n";

/***/ })

});