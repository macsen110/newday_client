<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Macsen 开发学习之道</title>
  <link rel="stylesheet" href="./res/main.css">
  <link rel="shortcut icon" href="//www.macsen318.com/favicon.ico" type="image/x-icon"/>
</head>

<body>

  <div id="container" class="container">
    <div class="header">
      <h1>梁玉森的个人网站</h1>
      <p>YuSen Liang Personal Website</p>
    </div>
    <div class="content">
      <div class="page-alpha">
        <p>»<a href="//github.com/macsen110/Blog">个人博客(Blog)</a></p>
        <p>»<a href="/zone">Lofter Zone</a></p>
        <p>»<a href="/ui/">ui 插件(yao-m-ui)</a></p>
        <p>»<a href="/pages">路由轮子 (yao-pages)</a></p>
        <p onclick="socketTogit()">»<a href="javascript:void(0)">Mini 美图秀秀</a></p>
      </div>
      
    </div>
    <div class="footer">
      <p><a href="mailto:839945193@qq.com">Contact</a> | macsen318.com</p>
    </div>
  </div>
  <script>    
    if (navigator.serviceWorker != null) {

    navigator.serviceWorker.register('./cache/sw.js')
    .then(function(registration) {
      console.log('Registered event22s at scope: ', registration.scope);
    });
  }



  </script>
</body>
<script>
      function xhr(opt) {
      this.method = 'GET';
      this.aysc = true;
      this.sendData = null;
      this.cache = true;
      if (typeof opt === 'object') {
        for (var i in opt) this[i] = opt[i];
      }
      this.send();
    }
    xhr.prototype = {
      constructor: xhr,
      send: function () {
        var _xhr = new XMLHttpRequest();
        _xhr.timeout = 60000;
        _xhr.open(this.method, this.url, this.aysc);
        this.withCredentials && (_xhr.withCredentials = true);
        if (this.setHeader) {
          _xhr.setRequestHeader("Content-Type", this.setHeader);
        }
        if (!this.cache) {
          _xhr.setRequestHeader("Pragma", "no-cache");
          _xhr.setRequestHeader("Cache-Control", "no-cache");
        }

        _xhr.onload = function () {
          if (_xhr.readyState === 4) {
            if (_xhr.status === 200) {
              var sucData;
              if (_xhr.response) {
                sucData = JSON.parse(_xhr.response);
              }
              this.done(sucData);
            }
            else {
              var error = new Error("something went wrong");
              this.faild(error);
            }
          }
        }.bind(this);
        _xhr.onerror = function (error) {
          this.faild(error);
        }.bind(this)
        _xhr.send(this.sendData)
      },
      done: function (data) {

      },
      faild: function () {

      }
    }
    var sendData = {
    "before": "fb32ef5812dc132ece716a05c50c7531c6dc1b4d", 
    "after": "ac63b9ba95191a1bf79d60bc262851a66c12cda1", 
    "ref": "refs/heads/master", 
    "user_id": 13,
    "user_name": "123", 
    "user": {
      "name": "123",
      "username": "test123",
      "url": "https://gitee.com/oschina"
    }, 
    "repository": {
        "name": "newday_server", 
        "url": "http://git.oschina.net/oschina/webhook", 
        "description": "", 
        "homepage": "https://gitee.com/oschina/webhook"
    }, 
    "commits": [
        {
            "id": "ac63b9ba95191a1bf79d60bc262851a66c12cda1", 
            "message": "1234 bug fix", 
            "timestamp": "2016-12-09T17:28:02 08:00", 
            "url": "https://gitee.com/oschina/webhook/commit/ac63b9ba95191a1bf79d60bc262851a66c12cda1", 
            "author": {
                "name": "123", 
                "email": "123@123.com", 
                "time": "2016-12-09T17:28:02 08:00"
            }
        }
    ], 
    "total_commits_count": 1, 
    "commits_more_than_ten": false, 
    "project": {
        "name": "webhook", 
        "path": "webhook", 
        "url": "https://gitee.com/oschina/webhook", 
        "git_ssh_url": "git@gitee.com:oschina/webhook.git", 
        "git_http_url": "https://gitee.com/oschina/webhook.git", 
        "git_svn_url": "svn://gitee.com/oschina/webhook", 
        "namespace": "oschina", 
        "name_with_namespace": "oschina/webhook", 
        "path_with_namespace": "oschina/webhook", 
        "default_branch": "master"
    }, 
    "hook_name": "push_hooks", 
    "password": "pwd"
}
function getFormDatafromObj(obj) {
	var str = '';
	var arr = [];
	for (var i in obj) {
		arr.push(i+'='+obj[i])
	}
	return arr.join('&')
}

function getDataByJson(obj) {
  return JSON.stringify(obj)
}
  function socketTogit() {
      new xhr({
        method: 'POST',
        url:'//www.macsen318.com/api/socket4git',
        sendData: getDataByJson(sendData),
        setHeader: 'application/json'
      })
  }
</script>
</html>
