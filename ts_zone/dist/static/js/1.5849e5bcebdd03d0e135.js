(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{12:function(t,e,i){t.exports=function(){function t(t){if(t&&"object"==typeof t)for(var e in t)this[e]=t[e];this.tabNavContainer=this.tabNavContainer||document.querySelector(".tab-nav-container"),this.tabConContainer=this.tabConContainer||document.querySelector(".tab-con-container"),this.tabNavContainer&&(this.tabNavItems=this.tabNavItems||this.tabNavContainer.children),this.tabConContainer&&(this.tabConItems=this.tabConItems||this.tabConContainer.children),this.curIdex=this.curIdex||0,this.init()}function e(t){return this.title=null,this.content=null,this.foot=null,this.canMaskClose=!0,this.className="",this.type="dialog",this.container=document.createElement("div"),this.isMask=!0,this.config(t),this.mask=this.isMask?'<div class="dialog-mask-bg"></div>':"",this.open(),this}function i(t,e){var i="ontouchstart"in window;if(!t)return null;this.element=t,this.parentEle=e.parentEle||this.element,this.child=t.children[0],this.length=t.children.length,this.focusIndex=e.focusIndex||0,this.index=e.index||0,this.speed=e.speed||300,this.offset=e.offset||0,this.limitBorder=e.limitBorder||!1,this.showNum=e.showNum||this.length,this.deltaX=0,this.deltaY=0,this.callback=e.callback||function(){},this.touchMoveCb=e.touchMoveCb||function(){},this.hasMoved=!1,this.orientation=e.orientation||1,this.distance=e.distance,this.parentEle.addEventListener&&(this.parentEle.addEventListener(i?"touchstart":"mousedown",this,!1),this.element.addEventListener("webkitTransitionEnd",this,!1),this.element.addEventListener("transitionend",this,!1)),1==this.orientation?(this.childWidth=e.childWidth||this.child.clientWidth,this.parentWidth=e.parentWidth||this.childWidth*this.length):(this.childHeight=e.childHeight||this.child.clientHeight,this.parentHeight=e.parentHeight||this.childHeight*this.length),this.init()}function n(t){"object"==typeof t&&Object.keys(t).forEach(function(e){this[e]=t[e]}.bind(this)),"string"!=typeof t&&"number"!=typeof t||(this.msg=t),this.init()}function s(t){return"object"==typeof t&&Object.keys(t).forEach(function(e){this[e]=t[e]}.bind(this)),this.html=this.html||'<div class="mask"></div><div class="spinner"></div>',this}return t.prototype={constructor:t,init:function(){var t=this;t.change(this.curIdex),t.tabNavItems&&[].forEach.call(t.tabNavItems,function(e,i){e.addEventListener("click",function(){t.change(i)})})},change:function(t){var e=this;e.curIdex=t,e.tabNavItems?[].forEach.call(e.tabNavItems,function(i,n){n!==t?(i.classList.remove("on"),e.tabConItems[n].classList.remove("on")):(i.classList.add("on"),e.tabConItems[n].classList.add("on"))}):[].forEach.call(e.tabConItems,function(e,i){i!==t?e.classList.remove("on"):e.classList.add("on")}),e.callback&&e.callback(t)}},e.prototype={constructor:e,config:function(t){if("object"==typeof t)for(var e in t)this[e]=t[e];return this},handleEvent:function(t){var e=t.target.classList;e.contains("dialog-mask-bg")?this.canMaskClose&&(this.maskAction?this.maskAction():this.close()):e.contains("btn-dialog-ok")?this.afterOk():(e.contains("btn-dialog-cancel")||e.contains("icon-dialog-cancel"))&&this.close()},open:function(){this.container.className="widget-dialog "+this.className,this.title=this.title?'<div class="title">'+this.title+"</div>":"",this.content=this.content?'<div class="content">'+this.content+"</div>":"",this.foot=this.foot?'<div class="foot">'+this.foot+"</div>":"",this.main=this.title+this.content+this.foot,this.container.innerHTML='<div class="main">'+this.main+"</div>"+this.mask,document.body.appendChild(this.container),this.afterOpen(),this.container.addEventListener("click",this)},afterOpen:function(){},afterOk:function(){this.destory()},close:function(){this.afterClose(),this.destory()},afterClose:function(){},destory:function(){var t=document.body;this.container&&(t.removeChild(this.container),this.container=null)}},i.prototype={constructor:i,init:function(){var t=this;[].forEach.call(t.element.children,function(e){1==t.orientation?e.style.width=t.childWidth+"px":e.style.height=t.childHeight+"px"}),1==t.orientation?t.element.style.width=t.parentWidth+"px":t.element.style.height=t.parentHeight+"px",1==t.orientation&&(t.element.style.MozTransform=t.element.style.webkitTransform="translate3d("+-(t.index-t.focusIndex)*t.childWidth+"px,0,0)"),2==t.orientation&&(t.element.style.MozTransform=t.element.style.webkitTransform="translate3d(0,"+-(t.index-t.focusIndex)*t.childHeight+"px,0)"),t.move(t.index)},handleEvent:function(t){switch(t.type){case"mousedown":this.element.addEventListener("mousemove",this,!1),this.element.addEventListener("mouseup",this,!1),this.element.addEventListener("mouseout",this,!1),this.onTouchStart(t);break;case"mousemove":this.onTouchMove(t);break;case"mouseup":case"mouseout":this.element.removeEventListener("mousemove",this,!1),this.element.removeEventListener("mouseup",this,!1),this.element.removeEventListener("mouseout",this,!1),this.onTouchEnd(t);break;case"touchstart":this.parentEle.addEventListener("touchmove",this,!1),this.parentEle.addEventListener("touchend",this,!1),this.onTouchStart(t);break;case"touchmove":this.onTouchMove(t);break;case"touchend":this.parentEle.removeEventListener("touchmove",this,!1),this.parentEle.removeEventListener("touchend",this,!1),this.onTouchEnd(t);break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"transitionend":this.transitionEnd(t)}},onTouchStart:function(t){this.start={pageX:t.touches[0].pageX,pageY:t.touches[0].pageY},this.element.style.webkitTransition="-webkit-transform 0ms"},onTouchMove:function(t){t.touches.length>1||t.scale&&1!==t.scale||(this.deltaX=t.touches[0].pageX-this.start.pageX,this.deltaY=t.touches[0].pageY-this.start.pageY,1==this.orientation&&Math.abs(this.deltaX)>Math.abs(this.deltaY)&&(t.preventDefault(),this.hasMoved||this.touchMoveCb&&this.touchMoveCb(this.index),this.element.style.MozTransform=this.element.style.webkitTransform="translate3d("+(this.deltaX-(this.index-this.focusIndex)*this.childWidth)+"px,0,0)"),2==this.orientation&&Math.abs(this.deltaY)>Math.abs(this.deltaX)&&(t.preventDefault(),this.hasMoved||this.touchMoveCb&&this.touchMoveCb(this.index),this.element.style.MozTransform=this.element.style.webkitTransform="translate3d(0,"+(this.deltaY-(this.index-this.focusIndex)*this.childHeight)+"px,0)"),this.hasMoved=!0)},onTouchEnd:function(t){if(this.hasMoved||(1==this.orientation&&(this.deltaX=0),2==this.orientation&&(this.deltaY=0)),this.hasMoved=!1,1==this.orientation){var e=this.childWidth;i=this.distance?(n=this.deltaX-parseInt(this.deltaX/e)*e)>0?this.index-(parseInt(this.deltaX/e)+(n-this.distance>0?1:0)):this.index-(parseInt(this.deltaX/e)+(Math.abs(n)-this.distance>0?-1:0)):this.index-Math.round(this.deltaX/e)}if(2==this.orientation){var i,n,s=this.childHeight;i=this.distance?(n=this.deltaY-parseInt(this.deltaY/s)*s)>0?this.index-(parseInt(this.deltaY/s)+(n-this.distance>0?1:0)):this.index-(parseInt(this.deltaY/s)+(Math.abs(n)-this.distance>0?-1:0)):this.index-Math.round(this.deltaY/s)}i=this.limitIndex(i),this.autoMove(i),this.callback&&(this.index,this.offset,this.callback(this.index))},transitionEnd:function(t){},autoMove:function(t){var e=this.element.style;e.webkitTransition="-webkit-transform "+this.speed+"ms",1==this.orientation&&(e.MozTransform=e.webkitTransform="translate3d("+-t*this.childWidth+"px,0,0)"),2==this.orientation&&(e.MozTransform=e.webkitTransform="translate3d(0,"+-t*this.childHeight+"px,0)"),this.index=t+this.focusIndex},move:function(t){t-=this.offset,t=this.limitIndex(t);var e=this.element.style;e.webkitTransition="-webkit-transform "+this.speed+"ms",1==this.orientation&&(e.MozTransform=e.webkitTransform="translate3d("+-t*this.childWidth+"px,0,0)"),2==this.orientation&&(e.MozTransform=e.webkitTransform="translate3d(0,"+-t*this.childHeight+"px,0)"),this.index=t+this.focusIndex,this.callback&&this.callback(this.index)},limitIndex:function(t){return this.limitBorder?t<0?t=0:t>this.length-this.showNum+this.focusIndex&&(t=this.length-(this.showNum-this.focusIndex)):t<-this.offset?t=-this.offset:t>this.length-1-this.offset&&(t=this.length-1-this.offset),t-this.focusIndex}},n.prototype={constructor:n,init:function(){this._container=document.querySelector(".widget-prompt"),this._container&&this.destory(),this.open()},open:function(){this._container=document.createElement("div"),this._container.className=this.className?this.className+" widget-prompt":"widget-prompt",this._container.innerHTML=this.msg,document.body.appendChild(this._container),this.promptTimer=setTimeout(function(){this.destory(),this.cb&&this.cb()}.bind(this),3e3)},destory:function(){this._container.parentNode.removeChild(this._container),this._container=null}},s.prototype={constructor:s,start:function(){this._container||(this._container=document.createElement("div"),this._container.innerHTML=this.html,this._container.className=this.className?this.className+" widget-loading":"widget-loading",document.body.appendChild(this._container)),this._container.style.display="block"},end:function(){this._container&&(this._container.style.display="none")}},{TabWidget:function(e){return new t(e)},Dialog:function(t){return new e(t)},easyMove:function(t,e){return new i(t,e)},showPrompt:function(t){return new n(t)},Loading:function(t){return new s(t)}}}()},19:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),s=i(9),o=i(6),a=i(12),h=i(36),c=i(37),r=n.useReducer,l=n.useEffect,d=n.useRef,u="00002";function m(t){var e,i=t.item;switch(t.category){case"image":e=n.createElement("img",{src:"//res.macsen318.com"+i.path,width:i.width});break;case"video":e=n.createElement("video",{src:"//res.macsen318.com"+i.path,autoPlay:!0});break;case"note":e=i.url?n.createElement("div",null,n.createElement("p",null,i.content),n.createElement("p",null,n.createElement("img",{src:"//res.macsen318.com"+i.path,width:i.width/2}))):n.createElement("p",null,i.content)}return n.createElement("li",{className:"item"},e)}function f(t){var e=t.commets,i=t.goodsid;return e.length?n.createElement("div",{className:"commets-container"},n.createElement("ul",{className:"commets-list"},e.map(function(t,e){return n.createElement(p,{goodsid:i,C_content:t.C_content,key:e,C_id:t._id})})),n.createElement(v,{goodsid:i})):n.createElement("div",{className:"commets-contain"},n.createElement(v,{goodsid:i}))}function p(t){var e=t.C_content,i=t.C_id,o=t.goodsid,h=function(t){!function(t,e){new Promise(function(i,n){new s.default({url:"/api/comments/"+e+"/"+t,method:"DELETE",done:function(e){return 0===e.code&&i(+t),e.code===u?a.showPrompt({msg:e.msg}):0!==e.code?a.showPrompt({msg:e.msg}):void 0}})})}(t.target.parentNode.dataset.id,o)};return n.createElement("li",{className:"item","data-id":i},n.createElement("span",{className:"con"},"游客评论: "+e),n.createElement("span",{className:"del",onClick:function(t){return h(t)}},"删除"))}function v(t){var e=d(null);return n.createElement("div",{className:"input-container"},n.createElement("textarea",{className:"ipt",ref:e}),n.createElement("p",null,n.createElement("button",{onClick:function(){var i,n,s,o=e.current;i=t.goodsid,n=o?o.value:"",s=JSON.stringify({goodsid:i,content:n}),fetch("https://www.macsen318.com/api/comments/",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:s}).then(function(t){if(t.ok)return t.json()}).then(function(t){return t.code===u?a.showPrompt({msg:t.msg}):0!==t.code?a.showPrompt({msg:t.msg}):void 0})},className:"btn"},"提交评论")))}e.default=function(t){var e=r(h.default,{}),i=e[0],a=e[1],d=r(c.default,[]),u=d[0],p=d[1],v=i.files||"";return l(function(){var e;(e=t.match.params.id,new Promise(function(t,i){new s.default({url:"/api/goods/detail/"+e,done:function(e){t(e)},faild:function(){var t=new Error("something wrong");i(t)}})})).then(function(t){a({type:o.SHOWGOOD,value:t.detail}),p({type:o.LISTCOMMETS,value:t.commets})})},[]),i.id?n.createElement("div",{className:"app-detail-page"},n.createElement("p",{className:"page-title"},i.title),v.length>0&&n.createElement("ul",{className:"uri-list"},v.map(function(t,e){return n.createElement(m,{key:e,item:t,category:i.category})})),""!=i.content&&n.createElement("p",{className:"content"},i.content),n.createElement(f,{commets:u,goodsid:i.id})):n.createElement("div",null,t.match.params.id)}},36:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6);e.default=function(t,e){switch(e.type){case n.SHOWGOOD:return e.value;default:return t}}},37:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6);e.default=function(t,e){switch(e.type){case n.POSTCOMMET:return t.push(e.value),t.slice();case n.LISTCOMMETS:return e.value;case n.DELETECOMMET:for(var i=void 0,s=0;s<t.length;s++)if(t[s]._id===e.value){i=s,t.splice(i,1);break}return t.slice();default:return t.slice()}}},6:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LOGIN="LOGIN",e.LOGOUT="LOGOUT",e.LISTGOODS="LISTGOODS",e.SHOWGOOD="SHOWGOOD",e.POSTCOMMET="POSTCOMMET",e.DELETECOMMET="DELETECOMMET",e.LISTCOMMETS="LISTCOMMETS",e.DONELOADING="DONELOADING"},9:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.method="GET",this.aysc=!0,this.sendData=null,this.cache=!0,"object"==typeof t&&Object.assign(this,t),this.url="https://www.macsen318.com"+this.url,this.send()}return t.prototype.send=function(){var t=this,e=new XMLHttpRequest;e.timeout=6e4,this.withCredentials&&(e.withCredentials=!0),e.withCredentials=!0,e.open(this.method,this.url,this.aysc),this.setHeader&&e.setRequestHeader("Content-Type",this.setHeader),this.cache||(e.setRequestHeader("Pragma","no-cache"),e.setRequestHeader("Cache-Control","no-cache")),e.onload=function(){if(4===e.readyState)if(200===e.status){var i;e.response&&(i=JSON.parse(e.response)),t.done(i)}else{var n=new Error("something went wrong");t.faild(n)}},e.onerror=function(e){t.faild(e)},e.send(this.sendData)},t}();e.default=n}}]);
//# sourceMappingURL=1.5849e5bcebdd03d0e135.js.map