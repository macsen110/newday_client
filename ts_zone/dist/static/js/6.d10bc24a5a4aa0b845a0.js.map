{"version":3,"sources":["webpack:///./script/build/actions/index.ts","webpack:///./script/build/components/register.tsx","webpack:///./script/build/utils/xhr.ts"],"names":["__webpack_require__","d","__webpack_exports__","LOGIN","LOGOUT","LISTGOODS","SHOWGOOD","POSTCOMMET","DELETECOMMET","LISTCOMMETS","r","react__WEBPACK_IMPORTED_MODULE_0__","_utils_xhr__WEBPACK_IMPORTED_MODULE_1__","yao_m_ui__WEBPACK_IMPORTED_MODULE_2__","_context__WEBPACK_IMPORTED_MODULE_3__","_actions__WEBPACK_IMPORTED_MODULE_4__","useRef","useContext","props","_a","dispatch","state","registerForm","id","className","method","action","ref","onSubmit","e","preventDefault","form","current","value","Object","formdata","username","password","Promise","resolve","reject","setHeader","sendData","url","withCredentials","done","callData","faild","error","Error","then","obj","code","type","msg","cb","history","push","pathname","console","log","name","placeholder","xhr","opt","this","aysc","cache","assign","send","prototype","_this","_xhr","XMLHttpRequest","timeout","open","setRequestHeader","onload","readyState","status","sucData","response","JSON","parse","onerror"],"mappings":"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","file":"static/js/6.d10bc24a5a4aa0b845a0.js","sourcesContent":["export const LOGIN = 'LOGIN'\nexport const LOGOUT = 'LOGOUT'\nexport const LISTGOODS = 'LISTGOODS';\nexport const SHOWGOOD = 'SHOWGOOD';\nexport const POSTCOMMET = 'POSTCOMMET';\nexport const DELETECOMMET = 'DELETECOMMET';\nexport const LISTCOMMETS = 'LISTCOMMETS';\nexport const DONELOADING = 'DONELOADING';","import * as React from 'react';\nimport xhr from '../utils/xhr';\nimport { showPrompt } from 'yao-m-ui';\nimport {FetchesContext} from '../context'\nimport {LOGIN} from '../actions'\nconst {\n    useRef,\n    useContext\n} = React\n\nfunction Register(props:any) {\n    const {state, dispatch} = useContext(FetchesContext)\n    let registerForm = useRef<HTMLFormElement>(null);\n    const handleSubmit = (e: any) => {\n        e.preventDefault();\n        var form = registerForm.current;\n        if (!form) return;\n        if (!form['username'].value) {\n            showPrompt('请填写用户名!');\n            return false;\n        }\n        if (!form['password'].value) {\n            showPrompt('请填写密码');\n            return false;\n        }\n        var url = '/api/users/saveuser';\n        var formdata = 'username=' + form.username.value + '&password=' + form.password.value + \"&test=\" + null;\n        return new Promise(function (resolve, reject) {\n            new xhr({\n                setHeader: 'application/x-www-form-urlencoded',\n                sendData: formdata,\n                method: 'POST',\n                url: url,\n                withCredentials: true,\n                done: function (callData) {\n                    resolve(callData)\n                },\n                faild: function () {\n                    var error = new Error('something wrong');\n                    reject(error)\n                }\n\n            })\n\n        }).then(\n            (obj:any) => {\n                if (obj.code === 0) {\n                    dispatch({ type: LOGIN })\n                    showPrompt({\n                        msg: obj.msg,\n                        cb: () => {\n                            dispatch({ type: LOGIN })\n                            props.history.push({ pathname: '/goods/upload' })\n                        }\n                    });\n                }\n                else showPrompt(obj.msg)\n            },\n            error => console.log(error)\n        )\n    }\n\n    return (\n        <div id=\"register_page\" className=\"app-register-page\">\n            <p className=\"page-title\">注册</p>\n            <form method=\"post\" action=\"/api/users/saveuser\" className=\"form1\" ref={registerForm} onSubmit={handleSubmit}>\n                <p className=\"pt20\"><input type=\"text\" name=\"username\" className=\"ipt\" placeholder=\"用户名\" /></p>\n                <p className=\"pt20\"><input type=\"password\" name=\"password\" className=\"ipt\" placeholder=\"密码\" /></p>\n                <p className=\"pt20\"><input type=\"submit\" className=\"btn\" /></p>\n            </form>\n        </div>\n    )\n}\nexport default Register;\n","class xhr {\n\tmethod: string;\n\taysc: boolean;\n\tsendData: any;\n\tcache: boolean;\n\turl: string;\n\tsetHeader: any;\n\tfaild: Function;\n\twithCredentials: true;\n\tdone: Function;\n\tconstructor(opt: any) {\n\t\tthis.method = 'GET';\n\t\tthis.aysc = true;\n\t\tthis.sendData = null;\n\t\tthis.cache = true;\n\t\tif (typeof opt === 'object') {\n\t\t\tObject.assign(this, opt);\n\t\t}\n\t\t//@ts-ignore\n\t\tthis.url = perfixerURL + this.url\n\t\tthis.send();\n\n\t}\n\tsend() {\n\t\tvar _xhr = new XMLHttpRequest();\n\t\t_xhr.timeout = 60000;\n\t\tthis.withCredentials && (_xhr.withCredentials = true);\n\t\t_xhr.withCredentials = true\n\t\t_xhr.open(this.method, this.url, this.aysc);\n\n\t\tif (this.setHeader) {\n\t\t\t_xhr.setRequestHeader(\"Content-Type\", this.setHeader);\n\t\t}\n\t\tif (!this.cache) {\n\t\t\t_xhr.setRequestHeader(\"Pragma\", \"no-cache\");\n\t\t\t_xhr.setRequestHeader(\"Cache-Control\", \"no-cache\");\n\t\t}\n\n\t\t_xhr.onload = () => {\n\t\t\tif (_xhr.readyState === 4) {\n\t\t\t\tif (_xhr.status === 200) {\n\t\t\t\t\tvar sucData;\n\t\t\t\t\tif (_xhr.response) {\n\t\t\t\t\t\tsucData = JSON.parse(_xhr.response);\n\t\t\t\t\t}\n\t\t\t\t\tthis.done(sucData);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar error = new Error(\"something went wrong\");\n\t\t\t\t\tthis.faild(error);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t_xhr.onerror = (error) => {\n\t\t\tthis.faild(error);\n\t\t}\n\t\t_xhr.send(this.sendData)\n\t}\n}\n\nexport default xhr;"],"sourceRoot":""}