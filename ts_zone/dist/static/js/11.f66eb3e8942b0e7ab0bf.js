(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{36:function(e,t,a){"use strict";var n=function(){function e(e){this.method="GET",this.aysc=!0,this.sendData=null,this.cache=!0,"object"==typeof e&&Object.assign(this,e),this.url="https://www.macsen318.com"+this.url,this.send()}return e.prototype.send=function(){var e=this,t=new XMLHttpRequest;t.timeout=6e4,this.withCredentials&&(t.withCredentials=!0),t.withCredentials=!0,t.open(this.method,this.url,this.aysc),this.setHeader&&t.setRequestHeader("Content-Type",this.setHeader),this.cache||(t.setRequestHeader("Pragma","no-cache"),t.setRequestHeader("Cache-Control","no-cache")),t.onload=function(){if(4===t.readyState)if(200===t.status){var a;t.response&&(a=JSON.parse(t.response)),e.done(a)}else{var n=new Error("something went wrong");e.faild(n)}},t.onerror=function(t){e.faild(t)},t.send(this.sendData)},e}();t.a=n},47:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return l});var n=a(0),s=a(36),i=a(32),r=n.useState,o=n.useRef,c=(n.useEffect,"00002");function l(e){var t=r("image"),a=t[0],l=t[1],u=r([]),m=u[0],p=u[1],d=r(""),h=d[0],f=(d[1],o(null));return n.createElement("div",{id:"app_upload_page",className:"app-upload-page"},n.createElement("p",{className:"page-title"},"添加文章"),n.createElement("form",{method:"post",action:"/api/goods/upload",className:"form1",onSubmit:function(t){t.preventDefault();var n=f.current;if(n){if(!n.title.value)return Object(i.showPrompt)("标题不能为空");if(!n.content.value)return Object(i.showPrompt)("内容不能为空");if("note"!==a&&0===m.length)return Object(i.showPrompt)("请上传"+{image:"图片",video:"视频"}[a]);var r=new FormData(n);new Promise(function(e,t){new s.a({cache:!1,sendData:r,method:"POST",url:"/api/goods/upload?time="+Date.parse((new Date).toString()),done:function(t){e(t)},faild:function(e){t(e)}})}).then(function(t){0==t.code?Object(i.showPrompt)({msg:t.msg,cb:function(){return e.history.push("/goods/list")}}):t.code===c&&Object(i.showPrompt)({msg:t.msg,cb:function(){return e.history.push("/user/login")}})},function(e){return console.log(e)})}},ref:f},n.createElement("p",{className:"pt20"},n.createElement("input",{type:"text",name:"title",className:"ipt",placeholder:"文章标题"})),n.createElement("div",{className:"select-type"},"发布",function(e){var t;switch(e){case"video":t="视频";break;case"note":t="笔记";break;case"image":default:t="图文"}return t}(a),n.createElement("i",{className:"sign"}),n.createElement("select",{name:"category",onChange:function(e){l(e.target.value),p([])},defaultValue:"image"},n.createElement("option",{value:"image"},"图文"),n.createElement("option",{value:"note"},"笔记"),n.createElement("option",{value:"video"},"视频"))),"note"!==a&&n.createElement("div",{className:"wrap-upload-ipt"},"上传",h,n.createElement("input",{type:"file",onChange:function(e){var t=[],a=e.target.files,n=0;for(n in a)n>=0&&t.push(a[n]);p(t)},multiple:!0,accept:a+"/*",name:"pics",className:"ipt",placeholder:"file"})),m.length>0&&n.createElement("ul",{className:"filesList"},m.map(function(e,t){return n.createElement("li",{className:"item",key:t},function(e){switch(a){case"image":return n.createElement("img",{src:function(e){return window.navigator.userAgent.indexOf("Chrome")>=1||window.navigator.userAgent.indexOf("Safari")>=1?window.webkitURL.createObjectURL(e):window.URL.createObjectURL(e)}(e)});case"video":return n.createElement("img",{src:"/imgs/video.jpg"});default:return""}}(e),n.createElement("em",{className:"filename"},e.name),n.createElement("em",null,e.size,"k"))})),n.createElement("p",{className:"pt20"},n.createElement("textarea",{className:"ipt",name:"content",placeholder:"正文"})),n.createElement("p",{className:"pt20"},n.createElement("input",{type:"submit",className:"btn",value:"提交文章"}))))}}}]);