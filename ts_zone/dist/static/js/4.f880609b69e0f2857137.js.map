{"version":3,"sources":["webpack:///./script/build/actions/index.ts","webpack:///./script/build/components/login.tsx","webpack:///./script/build/utils/xhr.ts"],"names":["__webpack_require__","d","__webpack_exports__","LOGIN","LOGOUT","LISTGOODS","SHOWGOOD","POSTCOMMET","DELETECOMMET","LISTCOMMETS","r","react__WEBPACK_IMPORTED_MODULE_0__","_utils_xhr__WEBPACK_IMPORTED_MODULE_1__","react_router_dom__WEBPACK_IMPORTED_MODULE_2__","yao_m_ui__WEBPACK_IMPORTED_MODULE_3__","_context__WEBPACK_IMPORTED_MODULE_4__","_actions__WEBPACK_IMPORTED_MODULE_5__","useRef","useContext","props","_a","dispatch","state","loginForm","id","className","method","action","ref","onSubmit","e","preventDefault","form","current","value","Object","senddata","JSON","stringify","username","password","test","Promise","resolve","reject","setHeader","sendData","url","done","callData","faild","error","Error","then","obj","code","msg","cb","type","history","push","pathname","console","log","name","placeholder","to","xhr","opt","this","aysc","cache","assign","send","prototype","_this","_xhr","XMLHttpRequest","timeout","withCredentials","open","setRequestHeader","onload","readyState","status","sucData","response","parse","onerror"],"mappings":"wFAAAA,EAAAC,EAAAC,EAAA,sBAAAC,IAAAH,EAAAC,EAAAC,EAAA,sBAAAE,IAAAJ,EAAAC,EAAAC,EAAA,sBAAAG,IAAAL,EAAAC,EAAAC,EAAA,sBAAAI,IAAAN,EAAAC,EAAAC,EAAA,sBAAAK,IAAAP,EAAAC,EAAAC,EAAA,sBAAAM,IAAAR,EAAAC,EAAAC,EAAA,sBAAAO,IAAO,IAAMN,EAAQ,QACRC,EAAS,SACTC,EAAY,YACZC,EAAW,WACXC,EAAa,aACbC,EAAe,eACfC,EAAc,+CCN3BT,EAAAU,EAAAR,GAAA,IAAAS,EAAAX,EAAA,GAAAY,EAAAZ,EAAA,GAAAa,EAAAb,EAAA,GAAAc,EAAAd,EAAA,GAAAe,EAAAf,EAAA,GAAAgB,EAAAhB,EAAA,GASIiB,EAAAN,EAAA,OACAO,EAAAP,EAAA,WAqEWT,EAAA,QAnEf,SAAeiB,GACL,IAAAC,EAAAF,EAAAH,EAAA,GAAQM,GAAPD,EAAAE,MAAOF,EAAAC,UACVE,EAAYN,EAAwB,MAoDxC,OACIN,EAAA,qBAAKa,GAAG,gBAAgBC,UAAU,qBAC9Bd,EAAA,mBAAGc,UAAU,cAAY,MACzBd,EAAA,sBAAMe,OAAO,OAAOC,OAAO,uBAAuBF,UAAU,QAAQG,IAAKL,EAAWM,SAtDvE,SAACC,GAClBA,EAAEC,iBACF,IAAIC,EAAOT,EAAUU,QACrB,GAAKD,EAAL,CACA,IAAKA,EAAe,SAAEE,MAElB,OADAC,OAAArB,EAAA,WAAAqB,CAAW,YACJ,EAEX,IAAKH,EAAe,SAAEE,MAElB,OADAC,OAAArB,EAAA,WAAAqB,CAAW,UACJ,EAEX,IAAIC,EAAWC,KAAKC,UAAU,CAC1BC,SAAUP,EAAe,SAAEE,MAC3BM,SAAUR,EAAe,SAAEE,MAC3BO,KAAM,OAEV,OAAO,IAAIC,QAAQ,SAAUC,EAASC,GAClC,IAAIhC,EAAA,EAAI,CACJiC,UAAW,mBACXC,SAAUV,EACVV,OAAQ,OACRqB,IAAK,uBACLC,KAAM,SAAUC,GACZN,EAAQM,IAEZC,MAAO,WACH,IAAIC,EAAQ,IAAIC,MAAM,mBACtBR,EAAOO,QAMdE,KACG,SAACC,GACmB,GAAZA,EAAIC,KACJpB,OAAArB,EAAA,WAAAqB,CAAW,CACPqB,IAAK,OACLC,GAAI,WACApC,EAAS,CAAEqC,KAAM1C,EAAA,IACjBG,EAAMwC,QAAQC,KAAK,CAAEC,SAAU,qBAItC1B,OAAArB,EAAA,WAAAqB,CAAWmB,EAAIE,MAExB,SAAAL,GAAS,OAAAW,QAAQC,IAAIZ,QAQrBxC,EAAA,mBAAGc,UAAU,QAAOd,EAAA,uBAAO+C,KAAK,OAAOM,KAAK,WAAWvC,UAAU,MAAMwC,YAAY,SACnFtD,EAAA,mBAAGc,UAAU,QAAOd,EAAA,uBAAO+C,KAAK,WAAWM,KAAK,WAAWvC,UAAU,MAAMwC,YAAY,QACvFtD,EAAA,mBAAGc,UAAU,QAAOd,EAAA,uBAAO+C,KAAK,SAASjC,UAAU,SACnDd,EAAA,mBAAGc,UAAU,QAAOd,EAAA,cAACE,EAAA,KAAI,CAACqD,GAAG,kBAAgB,0CCzE7D,IAAAC,EAAA,WAUC,SAAAA,EAAYC,GACXC,KAAK3C,OAAS,MACd2C,KAAKC,MAAO,EACZD,KAAKvB,SAAW,KAChBuB,KAAKE,OAAQ,EACM,iBAARH,GACVjC,OAAOqC,OAAOH,KAAMD,GAGrBC,KAAKtB,IAAM,4BAAcsB,KAAKtB,IAC9BsB,KAAKI,OAsCP,OAnCCN,EAAAO,UAAAD,KAAA,eAAAE,EAAAN,KACKO,EAAO,IAAIC,eACfD,EAAKE,QAAU,IACfT,KAAKU,kBAAoBH,EAAKG,iBAAkB,GAChDH,EAAKG,iBAAkB,EACvBH,EAAKI,KAAKX,KAAK3C,OAAQ2C,KAAKtB,IAAKsB,KAAKC,MAElCD,KAAKxB,WACR+B,EAAKK,iBAAiB,eAAgBZ,KAAKxB,WAEvCwB,KAAKE,QACTK,EAAKK,iBAAiB,SAAU,YAChCL,EAAKK,iBAAiB,gBAAiB,aAGxCL,EAAKM,OAAS,WACb,GAAwB,IAApBN,EAAKO,WACR,GAAoB,MAAhBP,EAAKQ,OAAgB,CACxB,IAAIC,EACAT,EAAKU,WACRD,EAAUhD,KAAKkD,MAAMX,EAAKU,WAE3BX,EAAK3B,KAAKqC,OAEN,CACJ,IAAIlC,EAAQ,IAAIC,MAAM,wBACtBuB,EAAKzB,MAAMC,KAIdyB,EAAKY,QAAU,SAACrC,GACfwB,EAAKzB,MAAMC,IAEZyB,EAAKH,KAAKJ,KAAKvB,WAEjBqB,EA1DA,GA4DejE,EAAA","file":"static/js/4.f880609b69e0f2857137.js","sourcesContent":["export const LOGIN = 'LOGIN'\nexport const LOGOUT = 'LOGOUT'\nexport const LISTGOODS = 'LISTGOODS';\nexport const SHOWGOOD = 'SHOWGOOD';\nexport const POSTCOMMET = 'POSTCOMMET';\nexport const DELETECOMMET = 'DELETECOMMET';\nexport const LISTCOMMETS = 'LISTCOMMETS';\nexport const DONELOADING = 'DONELOADING';","import * as React from 'react';\nimport xhr from '../utils/xhr';\nimport {\n    Link\n} from 'react-router-dom';\nimport { showPrompt } from 'yao-m-ui';\nimport {FetchesContext} from '../context'\nimport {LOGIN} from '../actions'\nconst {\n    useRef,\n    useContext\n} = React\nfunction Login(props) {\n    const {state, dispatch} = useContext(FetchesContext)\n    let loginForm = useRef<HTMLFormElement>(null);\n    const handleSubmit = (e: any) => {\n        e.preventDefault();\n        var form = loginForm.current;\n        if (!form) return;\n        if (!form['username'].value) {\n            showPrompt('请填写用户名!');\n            return false;\n        }\n        if (!form['password'].value) {\n            showPrompt('请填写密码');\n            return false;\n        }\n        var senddata = JSON.stringify({\n            username: form['username'].value,\n            password: form['password'].value,\n            test: null\n        });\n        return new Promise(function (resolve, reject) {\n            new xhr({\n                setHeader: 'application/json',\n                sendData: senddata,\n                method: 'POST',\n                url: '/api/users/validuser',\n                done: function (callData) {\n                    resolve(callData)\n                },\n                faild: function () {\n                    var error = new Error('something wrong')\n                    reject(error)\n                }\n\n            })\n\n        })\n            .then(\n                (obj: any) => {\n                    if (obj.code == 0) {\n                        showPrompt({\n                            msg: \"登陆成功\",\n                            cb: () => {\n                                dispatch({ type: LOGIN })\n                                props.history.push({ pathname: '/goods/upload' })\n                            }\n                        });\n                    }\n                    else showPrompt(obj.msg)\n                },\n                error => console.log(error)\n            )\n    }\n\n    return (\n        <div id=\"register_page\" className=\"app-register-page\">\n            <p className=\"page-title\">登录</p>\n            <form method=\"post\" action=\"/api/users/validuser\" className=\"form1\" ref={loginForm} onSubmit={handleSubmit}>\n                <p className=\"pt20\"><input type=\"text\" name=\"username\" className=\"ipt\" placeholder=\"用户名\" /></p>\n                <p className=\"pt20\"><input type=\"password\" name=\"password\" className=\"ipt\" placeholder=\"密码\" /></p>\n                <p className=\"pt20\"><input type=\"submit\" className=\"btn\" /></p>\n                <p className=\"pt10\"><Link to=\"/user/register\">注册</Link></p>\n            </form>\n        </div>\n    )\n\n}\nexport default Login;","class xhr {\n\tmethod: string;\n\taysc: boolean;\n\tsendData: any;\n\tcache: boolean;\n\turl: string;\n\tsetHeader: any;\n\tfaild: Function;\n\twithCredentials: true;\n\tdone: Function;\n\tconstructor(opt: any) {\n\t\tthis.method = 'GET';\n\t\tthis.aysc = true;\n\t\tthis.sendData = null;\n\t\tthis.cache = true;\n\t\tif (typeof opt === 'object') {\n\t\t\tObject.assign(this, opt);\n\t\t}\n\t\t//@ts-ignore\n\t\tthis.url = perfixerURL + this.url\n\t\tthis.send();\n\n\t}\n\tsend() {\n\t\tvar _xhr = new XMLHttpRequest();\n\t\t_xhr.timeout = 60000;\n\t\tthis.withCredentials && (_xhr.withCredentials = true);\n\t\t_xhr.withCredentials = true\n\t\t_xhr.open(this.method, this.url, this.aysc);\n\n\t\tif (this.setHeader) {\n\t\t\t_xhr.setRequestHeader(\"Content-Type\", this.setHeader);\n\t\t}\n\t\tif (!this.cache) {\n\t\t\t_xhr.setRequestHeader(\"Pragma\", \"no-cache\");\n\t\t\t_xhr.setRequestHeader(\"Cache-Control\", \"no-cache\");\n\t\t}\n\n\t\t_xhr.onload = () => {\n\t\t\tif (_xhr.readyState === 4) {\n\t\t\t\tif (_xhr.status === 200) {\n\t\t\t\t\tvar sucData;\n\t\t\t\t\tif (_xhr.response) {\n\t\t\t\t\t\tsucData = JSON.parse(_xhr.response);\n\t\t\t\t\t}\n\t\t\t\t\tthis.done(sucData);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar error = new Error(\"something went wrong\");\n\t\t\t\t\tthis.faild(error);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t_xhr.onerror = (error) => {\n\t\t\tthis.faild(error);\n\t\t}\n\t\t_xhr.send(this.sendData)\n\t}\n}\n\nexport default xhr;"],"sourceRoot":""}