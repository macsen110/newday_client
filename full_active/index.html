<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title></title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    .box {
      display: inline-block;
      text-align: center;
      border-radius: 4px;
      padding: 12px 8px;
    }

    .flip .digit {
      color: #fff;
      font-size: 28px;
      font-weight: 900;
      padding: 10px 5px;
      text-align: center;
    }

    .flip .ctnr {
      background: #282828;
    }

    .flip .ctnr:last-of-type .digit {
      color: #ff6161;
      font-weight: 300;
      transform: scale(.62);
    }




    .slot .digit {
      margin: 0 4px;
      font-family: futura;
    }

    html {
      height: 100%;
      width: 100%;
    }

    body {
      height: 100%;
      width: 100%;
      background: url(./imgs/bg.png) no-repeat;
      background-size: cover;
      color: #89ddff;
    }

    .box {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate3d(-50%, -50%, 0);
      width: 100%;
      font-size: 88px;
      
    }
  </style>
</head>

<body>


  <div class="box">
    <div class="separate"></div>
  </div>


  <script src="js/number-flip.min.js"></script>
  <script>
    /*eslint no-console: ["error", { allow: ["log", "warn"] }] */
    class xhr {
      constructor(opt) {
        this.method = "GET";
        this.aysc = true;
        this.sendData = null;
        this.cache = true;
        if (typeof opt === "object") {
          Object.assign(this, opt);
        }
        this.send();
      }
      send() {
        var _xhr = new XMLHttpRequest();
        _xhr.timeout = this.timeout || 60000;
        _xhr.open(this.method, this.url, this.aysc);
        if (this.dataType) _xhr.responseType = this.dataType;
        this.withCredentials && (_xhr.withCredentials = true);
        _xhr.crossDomain = this.crossDomain || false;
        if (!this.isFormData)
          _xhr.setRequestHeader(
            "Content-Type",
            this.contentType || "application/x-www-form-urlencoded; charset=UTF-8"
          );
        if (!this.cache) {
          _xhr.setRequestHeader("Pragma", "no-cache");
          _xhr.setRequestHeader("Cache-Control", "no-cache");
        }
        if (typeof this.headers === 'object') {
          for (let i in this.headers) _xhr.setRequestHeader(i, this.headers[i]);
        }
        _xhr.onload = function () {
          if (_xhr.readyState === 4) {
            if (_xhr.status === 200) {
              var sucData = _xhr.response;
              if (typeof _xhr.response === "string") {
                sucData = JSON.parse(sucData);
              }
              this.done(sucData);
            } else {
              var error = new Error("something went wrong");
              this.faild(error);
            }
          }
        }.bind(this);
        _xhr.onerror = function (error) {
          this.faild(error);
        }.bind(this);
        _xhr.send(this.sendData);
      }
      done(data) {
        console.log(data);
      }
      faild() { }
    }


    const $ = s => document.querySelector(s)
    let sepa;
    let start;
    new xhr({
      url: 'https://yzadmin.111.com.cn/statistics/v1/count',
      method: 'POST',
      done: (res) => {
        sepa = new Flip({
          node: $('.separate'),
          from: res.data.inquery,
          duration: 1,
          separator: ','
        })
        start()

      }
    })

    // .separate
    start = () => setInterval(() => {
      new xhr({
        url: 'https://yzadmin.111.com.cn/statistics/v1/count',
        method: 'POST',
        done: (res) => {
          console.log(res.data.inquery)
          sepa.flipTo({
            to: res.data.inquery
          })

        }
      })
    }, 4000)




    //fetch('https://yzadmin.111.com.cn/statistics/v1/count').then()


  </script>
</body>

</html>